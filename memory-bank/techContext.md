# Technical Context: Технологии и инструменты

## Основные технологии
- **Frontend**: HTML5, CSS3, Vanilla JavaScript (ES6+)
- **Хранение данных**: Markdown-файлы, JSON для индекса и конфигурации
- **Автоматизация**: Node.js, GitHub Actions
- **Хостинг**: GitHub Pages и другие статические хостинги
- **Рендеринг**: Гибридный (SPA + статические HTML-файлы)
- **Интеграция**: Telegram Instant View

## Зависимости
### Производственные
- Минимальный набор библиотек, основной код написан на vanilla JavaScript
- Markdown-парсер (встроенный в клиентский код)
- Gray-matter для работы с frontmatter
- Marked 15.x для конвертации Markdown в HTML
- marked-smartypants для типографского форматирования текста 
- marked-gfm-heading-id для автоматических ID заголовков и навигации

### Разработка и инфраструктура
- Node.js (для скриптов генерации индекса и статических HTML)
- `serve` (для локальной разработки)

## Настройка окружения разработки
```bash
# Клонирование репозитория
git clone https://github.com/region23/pavlenko.tech.git
cd pavlenko.tech

# Установка зависимостей
npm install

# Запуск локального сервера разработки
npm start

# Обновление индекса статей
npm run update-index

# Генерация статических HTML-файлов
npm run generate-static

# Полная сборка (индекс + статические файлы)
npm run build

# Упрощенный деплой
npm run deploy
```

## Структура системы
```
/
├── .github/
│   └── workflows/
│       ├── update-content.yml    # GitHub Actions для обновления индекса и генерации статических HTML
│       └── github-pages.yml    # GitHub Actions для деплоя на GitHub Pages
├── .cursor/
│   └── rules/                  # Правила для IDE Cursor
├── content/
│   ├── about/
│   │   └── index.md            # Информация о блоге/авторе
│   └── posts/
│       ├── index.json          # Индекс всех статей
│       ├── example-post.md     # Статьи в формате Markdown
│       └── hello-world.md
├── css/
│   └── style.css               # Стили сайта
├── docs/
│   ├── hybrid-rendering.md     # Документация по гибридному рендерингу
│   └── telegram-instant-view.md # Документация по Telegram Instant View
├── js/
│   ├── app.js                  # Основной JS-код
│   ├── config.js               # Модуль для работы с конфигурацией
│   ├── content.js              # Работа с контентом
│   ├── router.js               # Маршрутизация
│   └── ui.js                   # Пользовательский интерфейс
├── images/                     # Изображения для сайта
├── memory-bank/                # Документация проекта
│   ├── activeContext.md
│   ├── productContext.md
│   ├── progress.md
│   ├── projectbrief.md
│   ├── systemPatterns.md
│   └── techContext.md
├── scripts/
│   ├── generate-index.js       # Скрипт для обновления индекса
│   └── generate-static.js      # Скрипт для генерации статических HTML
├── static/
│   └── posts/                  # Статические HTML-версии статей
├── .gitignore                  # Исключения для Git
├── .htaccess                   # Правила перенаправления и обнаружения ботов
├── .nojekyll                   # Отключение обработки Jekyll для GitHub Pages
├── 404.html                    # Страница 404
├── _redirects                  # Правила перенаправления для Netlify
├── config.json                 # Конфигурация блога
├── favicon.ico                 # Иконка сайта
├── index.html                  # Главная страница (SPA)
├── package.json                # Зависимости и скрипты
├── telegram-iv-template.txt    # Шаблон для Telegram Instant View
└── README.md                   # Документация проекта
```

## Рабочие процессы и инструменты

### Локальная разработка
1. Запуск сервера: `npm start`
2. Обновление индекса: `npm run update-index`
3. Генерация статических HTML: `npm run generate-static`
4. Полная сборка: `npm run build`
5. Просмотр в браузере по адресу: `http://localhost:3000`

### Деплой
1. Автоматический через GitHub:
   - Коммит изменений: `git commit -m "Сообщение"`
   - Пуш изменений: `git push origin master`
   - GitHub Actions автоматически обновит индекс и сгенерирует статические HTML
   - GitHub Pages автоматически обновит сайт

2. Упрощенный через npm-скрипт:
   - `npm run deploy` (объединяет build, add, commit и push)

### Обновление контента
1. Создание/редактирование .md файлов
2. Использование frontmatter для метаданных
3. Автоматическое обновление индекса и генерация статических HTML при пуше

### Настройка системы
1. Редактирование config.json
2. Выбор цветов, шрифтов, параметров отображения
3. Настройка метаданных сайта (заголовок, описание и т.д.)
4. Настройка навигации и социальных ссылок

## Технические ограничения
- Отсутствие серверной обработки (только статические файлы)
- Все данные должны быть подготовлены заранее или загружены на клиенте
- Необходимость прямого доступа к файлам .md для чтения их содержимого
- Ограничения статических хостингов
- Необходимость перегенерации статических HTML при изменении шаблонов

## Технические решения
### Гибридный рендеринг
- Для обычных пользователей: SPA с клиентским рендерингом
- Для поисковых роботов: предварительно сгенерированные HTML-файлы
- Механизм определения типа клиента через .htaccess

### Система конфигурации
- Централизованное хранение настроек в config.json
- Глубокое слияние настроек с значениями по умолчанию
- Применение настроек внешнего вида через CSS-переменные
- Доступ к настройкам через функцию get() с поддержкой путей

### Markdown рендеринг
- Библиотека marked 15.x для конвертации Markdown в HTML
- Расширение marked-smartypants для улучшения типографики (преобразование кавычек, тире и т.д.)
- Расширение marked-gfm-heading-id для автоматической генерации ID заголовков в стиле GitHub
- Кастомный рендерер для кода, ссылок и изображений
- Поддержка подсветки синтаксиса в блоках кода

### Telegram Instant View
- Шаблон в формате IV 2.1
- Поддержка как SPA, так и статических HTML-версий
- Автоматическое определение типа страницы

## Инструменты разработки
- Visual Studio Code / Cursor - основной редактор кода
- Git - система контроля версий
- npm - менеджер пакетов
- GitHub - хостинг репозитория и CI/CD
- Telegram IV Platform - для тестирования шаблонов Instant View 